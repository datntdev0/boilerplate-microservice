# Architecture Overview: Enterprise SaaS Microservice Boilerplate

This Architecture Overview Document (AOD) provides a structured blueprint for the Enterprise Microservice Boilerplate. It translates the high-level business requirements into a technical design, ensuring the system is scalable, secure, and multi-tenant by default.

## ğŸ¯ Project Vision

To empower development teams to launch enterprise-grade, multi-tenant SaaS products in days rather than months by providing a standardized, reusable microservice boilerplate that enables teams to initialize production-ready SaaS projects, with built-in multi-tenancy, authorization, real-time notifications, and other common enterprise-grade features.

**Architectural Goals and Constraints:**
- Goals: Rapid kick-off for SaaS projects; built-in multi-tenancy, SSO/RBAC, real-time notifications; reusable and extensible design; good quality software development practices.
- Constraints: Limited to specified stack (.NET Aspire, Angular, Kafka); no custom domain features; supports autoscaling and event-driven patterns.

## ğŸ› ï¸ High-level System Architecture


The container diagram provides a mid-level view of the runtime environment for the SaaS microservice boilerplate, detailing deployable containers (applications, databases, brokers) and their interactions via synchronous (gRPC/HTTP) and asynchronous (Kafka) protocols.

**Container Diagram:**
<picture>
    <source media="(prefers-color-scheme: dark)" srcset="../9.attachments/02.container-diagram-dark.svg">
    <source media="(prefers-color-scheme: light)" srcset="../9.attachments/02.container-diagram-light.svg">
    <img alt="System Context Diagram" src="../9.attachments/02.container-diagram.svg">
</picture>

The architecture follows a decoupled, polyglot persistence approach, orchestrated primarily within the .NET Aspire framework. Key components include:

### 1. Frontend Applications (Frontend Clients)

The entry point for users consists of three distinct client applications, ensuring a seamless experience across all platforms. These connect via Cloudflare for edge security and content delivery.

- **Mobile App (Flutter):** Cross-platform mobile client.
- **Web SPA (Angular):** A rich, single-page web application.
- **Desktop App (Electron):** A cross-platform desktop wrapper.

### 2. .NET Aspire Orchrestrator (Backend Services)

The core business logic is housed within a .NET Aspire container, which manages the lifecycle and configuration of the microservices. Key microservices include:

Service Name | Technology | Description
------------ | ---------- | -----------
API Gateway | .NET YARP | Routes requests to appropriate microservices.
Srv.Identity | .NET Web API | Handles authentication, authorization, and user profiles.
Srv.Admin | .NET Web API | Manages administrative tasks and system configurations.
Srv.Notify | .NET Web API | Manages system notifications and alerts.
Srv.Payment | .NET Web API | Orchestrates financial transactions and payment flows.

### 3. Internal Data Storages

The system utilizes Polyglot Persistence, choosing the best database engine for the specific data requirements of each service. This data storage services are isolated as the internal data layer by using containerized databases.

- **Relational (SQL Server):** Used by Srv.Identity and Srv.Payment where ACID compliance and complex relationships are critical.
- **Document-based (MongoDB):** Used by Srv.Admin and Srv.Notify for flexible schema handling and high-volume data ingest.

### 4. Internal Infrastructure Services

These components support inter-service communication and system performance:
- **Messaging (Apache Kafka):** Facilitates asynchronous, event-driven communication between microservices.
- **Caching (Redis):** An in-memory data store used to reduce latency and database load for frequently accessed data.
- **DB Migrator:** This tool runs on private runner as part of the CI/CD pipeline to ensure databases are up-to-date with the latest schema changes. 

### 5. External integrations & DevOps

The system relies on several third-party platforms to extend functionality and manage the development lifecycle.

**External Services:**
- PayPal: Processes actual financial transactions.
- Resend: Handles the delivery of transactional emails.
- Grafana Cloud: Provides centralized observability, logs, and performance monitoring.

**DevOps Ecosystem:**
- GitHub: Version control and CI/CD pipelines.
- SonarQube: Automated code quality and security scanning.
- Microsoft Teams: Integrated for automated alerts and team collaboration.

## ğŸ“ The High-Level Repository Structure

The repository is organized into several key directories, each serving a specific purpose in the development and deployment of the SaaS microservice boilerplate.

```
boilerplate-microservice/
â”œâ”€â”€ .github/
â”‚   â”œâ”€â”€ workflows/          # GitHub Actions CI/CD workflows
|   â”œâ”€â”€ instructions/       # Contribution and issue templates
|   â””â”€â”€ prompts/            # AI-assisted code generation prompts
â”œâ”€â”€ docs/                   # Documentation files
â”œâ”€â”€ srcs/                     
â”‚   â”œâ”€â”€ apps/               # Frontend and backend applications
â”‚   â”‚   â”œâ”€â”€ Angular/        # Angular SPA client
â”‚   â”‚   â””â”€â”€ Identity/       # Blazor SSR Identity Provider
|   â”œâ”€â”€ infra/
â”‚   â”‚   â”œâ”€â”€ Aspire/         # .NET Aspire orchestrator
â”‚   â”‚   â”œâ”€â”€ Gateway/        # .NET YARP API Gateway
â”‚   â”‚   â””â”€â”€ Migrator/       # .NET Database Migrator
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ Admin/          # Administration microservice
â”‚   â”‚   â”œâ”€â”€ Identity/       # Identity microservice
â”‚   â”‚   â”œâ”€â”€ Notify/         # Notification microservice
â”‚   â”‚   â””â”€â”€ Payment/        # Payment microservice
â”‚   â””â”€â”€ shared/             # Shared backend libraries
â””â”€â”€ tests/                  
    â”œâ”€â”€ Playwright/         # Playwright Testing Framework for E2E tests
    â”œâ”€â”€ Srv.Admin/          # Aspire Testing Framework: Admin microservice
    â”œâ”€â”€ Srv.Identity/       # Aspire Testing Framework: Identity microservice
    â”œâ”€â”€ Srv.Notify/         # Aspire Testing Framework: Notification microservice
    â””â”€â”€ Srv.Payment/        # Aspire Testing Framework: Payment microservice
```

## ğŸ” System Security Considerations

**Comprehensive Security:** Implement multi-layered security measures to protect data and services.

**Best Practices:** Follow industry standards and best practices for application security.